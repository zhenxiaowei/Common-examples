<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jp.co.sas.cms.bizshare.dao.AaTemplateInfoDao">
	<resultMap type="jp.co.sas.cms.bizshare.dto.AaTemplateInfoDto"
		id="AaTemplateInfoBean">
		<result column="template_id" property="templateId" />
		<result column="meta_id" property="metaId" />
		<result column="display_order" property="order" />
	</resultMap>
	<select id="selectMetaId" parameterType="String" resultMap="AaTemplateInfoBean">
		SELECT *
		FROM aa_template_info
		where meta_id=#{metaId}
	</select>
	<select id="templateById" parameterType="String" resultMap="AaTemplateInfoBean">
		SELECT *
		FROM aa_template_info
		where template_id=#{templateId}  order by    display_order  asc
	</select>
	<select id="countcm"   parameterType="jp.co.sas.cms.bizshare.dto.AaTemplateInfoDto"   resultType="int">
		SELECT
		count(1)
		FROM
        aa_contents ac
        LEFT JOIN
        aa_contents_info aci on aci.contents_id = ac.contents_id
		WHERE
		ac.template_id=#{templateId}
        and aci.meta_id =#{metaId}
        <![CDATA[
	   and aci.value <>''
		]]>
     
	</select>
	<delete id="deleteByTemplateIdAndMetaId" parameterType="String">
		DELETE FROM aa_template_info
		WHERE template_id=#{templateId}
	</delete>
	<select id="templateList" resultType="jp.co.sas.cms.bizshare.dto.AaTemplateDto">
		SELECT template_id
		templateId,meta_id metaId
		FROM aa_template_info
	</select>
	<insert id="aaTemplateInfoRegister" parameterType="jp.co.sas.cms.bizshare.dto.AaTemplateInfoDto">
		INSERT INTO aa_template_info
		(template_id
		,meta_id
		,display_order
		)
		VALUES
		(
		#{templateId},
		#{metaId},
		#{order}
		)
	</insert>
</mapper>